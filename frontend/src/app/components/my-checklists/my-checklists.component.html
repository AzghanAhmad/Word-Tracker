<div class="checklists-page">
    <!-- Hero Branding Section -->


    <div class="container fade-in">
        <header class="page-header">
            <div class="welcome-section">
                <h1>Welcome to <span>AuthorFlow</span></h1>
                <p>Track your progress and stay organized Checklists</p>
            </div>
            <a routerLink="/create-checklist" class="btn-create-new">
                <i class="fas fa-plus"></i> Create New
            </a>
        </header>

        <app-content-loader *ngIf="isLoading"></app-content-loader>

        <div class="empty-state" *ngIf="!isLoading && checklists.length === 0">
            <i class="fas fa-clipboard-check"></i>
            <h3>No checklists found</h3>
            <p>Create your first checklist to stay organized!</p>
        </div>

        <div class="checklist-grid" *ngIf="!isLoading && checklists.length > 0">
            <div class="checklist-card" *ngFor="let list of checklists">
                <div class="card-header">
                    <h3>{{ list.name || list.title || 'Untitled Checklist' }}</h3>
                    <div class="card-actions">
                        <a [routerLink]="['/create-checklist']" [queryParams]="{edit: list.id}" class="btn-icon edit"
                            title="Edit Checklist">
                            <i class="fas fa-edit"></i>
                        </a>
                        <button class="btn-icon delete" (click)="deleteChecklist(list.id); $event.stopPropagation()"
                            title="Delete Checklist">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="btn-icon archive" (click)="archiveChecklist(list.id); $event.stopPropagation()"
                            title="Archive Checklist">
                            <i class="fas fa-archive"></i>
                        </button>
                    </div>
                </div>

                <div class="task-status-label">Task Status</div>
                <div class="progress-bar-container">
                    <div class="progress-bar" [style.width.%]="getCompletionPercentage(list)"></div>
                </div>
                <div class="progress-text">
                    {{ getCompletedCount(list) }} / {{ list.items?.length || 0 }} completed
                </div>

                <div class="items-preview">
                    <div class="item" *ngFor="let item of list.items | slice:0:3" (click)="toggleItem(list.id, item)"
                        style="cursor: pointer;">
                        <i [ngClass]="item.is_done ? 'fa-solid fa-square-check' : 'fa-regular fa-square'"></i>
                        <span [class.done]="item.is_done">{{ item.text }}</span>
                    </div>
                    <div class="more-items" *ngIf="(list.items?.length || 0) > 3">
                        +{{ (list.items?.length || 0) - 3 }} more...
                    </div>
                </div>

                <div class="card-footer">
                    <span class="date" *ngIf="list.created_at">{{ list.created_at | date:'mediumDate' }}</span>
                    <button class="btn-secondary small" [routerLink]="['/create-checklist']"
                        [queryParams]="{edit: list.id}">
                        View / Edit
                    </button>
                </div>
            </div>
        </div>

        <div class="pagination-controls" *ngIf="totalPages > 1 && !isLoading">
            <div class="page-size">
                <label>Show:</label>
                <select (change)="onPageSizeChange($event)">
                    <option [value]="10" [selected]="itemsPerPage === 10">10</option>
                    <option [value]="20" [selected]="itemsPerPage === 20">20</option>
                    <option [value]="50" [selected]="itemsPerPage === 50">50</option>
                </select>
            </div>
            <div class="page-nav">
                <button (click)="prevPage()" [disabled]="currentPage === 1">Previous</button>
                <span>Page {{ currentPage }} of {{ totalPages }}</span>
                <button (click)="nextPage()" [disabled]="currentPage === totalPages">Next</button>
            </div>
        </div>
    </div>